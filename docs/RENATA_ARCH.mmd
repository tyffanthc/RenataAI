flowchart LR
  subgraph Entry
    A[main.py] --> B[RenataApp gui/app.py]
    A --> C[MainLoop app/main_loop.py]
  end

  subgraph Journal
    C --> D[EventHandler logic/event_handler.py]
    C --> E[StatusWatcher app/status_watchers.py]
    C --> F[MarketWatcher app/status_watchers.py]
    C --> G[CargoWatcher app/status_watchers.py]
    E --> D
    F --> D
    G --> D
  end

  subgraph Events
    D --> H[navigation_events]
    D --> I[fuel_events]
    D --> J[trade_events]
    D --> K[exploration_*]
    D --> L[smuggler_events]
  end

  H --> M[app_state app/state.py]
  K --> M
  M --> N[ship_state logic/ship_state.py]
  N --> O[jump_range_engine logic/jump_range_engine.py]
  N --> P[fit_resolver logic/fit_resolver.py]

  subgraph Spansh
    Q[GUI tabs] --> R[route_manager app/route_manager.py]
    R --> S[logic/* planners]
    S --> T[spansh_payloads logic/spansh_payloads.py]
    S --> U[spansh_client logic/spansh_client.py]
    U --> V[SPANSH API]
    U --> W[cache_store/dedup]
    S --> X[rows_normalizer logic/rows_normalizer.py]
    X --> Y[table_schemas gui/table_schemas.py]
    Y --> Z[render list gui/common.py]
  end

  subgraph Clipboard
    Z --> AA[route_clipboard logic/route_clipboard.py]
    AA --> AB[NEXT_HOP auto-clipboard]
  end

  subgraph Config
    AC[user_settings.json] --> AD[ConfigManager config.py]
    AD --> Q
    AD --> D
    AE[config.json] --> AF[RenataConfig logic/config.py]
  end

  B --> Z
  B --> AA